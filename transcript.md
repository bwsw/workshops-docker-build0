# Workshop #1 "Isolating application"

## step 0: WTF?

### Что такое image
Docker image это образ наподобие образов виртуальных машин.
Образы можно заполучить из репозиториев или собрать по Dockerfile.

Образ хранит в себе: содержимое файловой системы, метаданные, значения переменных окружения.

```
docker pull ubuntu:16.04
docker pull alpine:latest
docker images
```

### Что такое Dockerfile

Для создания образов используется Dockerfile - своеобразный сценарий для создания образа.
Данный файл включает в себя различные иснтрукции, извеняющие состояние системы, которое в последствии фиксируется в образе.

Для сборки образа используется команда `docker build`.
 
```
cat step0/Dockerfile
docker build -t step0 step0
```

### Что такое слои
Образ состоит из слоев. Каждый слой есть результыт выполнения одной команды Dockerfile.

```
docker history ubuntu:16.04
```

## Step 1: Syntax

```
# Comment
INSTRUCTION arguments
```

Рассмотрим основные команды Dockerfile:
* `FROM <image:tag>` - выбор базового образа, на основе котрого мы будем сроить свой образ. Всегда идет первой командой.
* `ENV <key>=<value>` - задание значения переменным окружения внутри образа
* `RUN <command>` - выполнение команды в текущем состоянии образа и фиксация результата воздействия на файловую систему или переменные окружения.
* `ADD/COPY <source> <destination>` - добавление в образ файлов извне
* `WORKDIR <path>` - задание стартовой директории для образа
* `VOLUME <path>` - указание точек монтирования в файловой сиситеме образа
* `EXPOSE <port>` - указание портов, которые образ "намеревается" использовать
* `CMD <command>` - указание команды по-умолчанию для запуска образа
* `ENTRYPOINT <command>` - указание команды для запуска образа. В случае использования данной директивы, `CMD` стоит рассматривать как набор аргументов для `ENTRYPOINT`

Набор существующих директив больше. Детально изучить синтаксис Dockerfile можно на оф. сайте: https://docs.docker.com/engine/reference/builder/
 
### Задача

Создадим приложение "hello $lastname".

```
cat step1/Dockerfile
cat step1/hello.sh
```

**Задание**: сделать образ, при запуске которого, на экране будет появляться приветствие в ваш адрес.
```
docker build -t step1 step1
docekr run --rm -it step1
```

